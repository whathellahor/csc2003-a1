{% extends "layout.html" %}

{% block title %}
RACER
{% endblock %}

{% block main %}

<div text-align="center" style="background-color:#ffffff">
    <div class="hero-text">
        <p><img src="/static/img/racerlogo_b.png"><br></p>
        <div>
            <div>
                <btn type="button" class="btn btn-info" onclick="getData()">Get Data</btn>
            </div>
            <br>
            <table class="table table-borderless">
                    <!-- <tr>
                        <th>Other Events: </th>
                        <td><input id="car_event" type="text" class="form-control" placeholder="Other events detected" value="None" disabled></td>
                    </tr> -->
                    <tr>
                        <th>Humps:</th> 
                        <td><input id="hump_number" type="number" class="form-control" placeholder="No. of humps detected" value=0 disabled></td>
                        <td><input id="car_hump" type="text" class="form-control" placeholder="Hump detected" value="None" disabled></td>
                    </tr>
                    <tr>
                        <th>Turns: </td>
                        <td><input id="turn_number" type="number" class="form-control" placeholder="No. of turns detected" value=0 disabled></td>
                        <td><input id="car_turn" type="text" class="form-control" placeholder="Turn detected" value="None" disabled></td>
                    </tr>
                    <tr>
                        <th>Barcode: </th>
                        <td><input id="car_barcode" type="text" class="form-control" placeholder="Barcode" value="None" disabled></td>
                    </tr>
                    <tr>
                        <th>Distance: </th>
                        <td><input id="car_distance" type="text" class="form-control" placeholder="Distance travelled" disabled></td>
                    </tr>
                    <tr>
                        <th>Speed: </th>
                        <td><input id="car_speed" type="text" class="form-control" placeholder="Speed" disabled></td>
                    </tr>
            </table>
        </div>
        <table class="table">
            <tr>
                <th colspan="3">Map Data</th>
            </tr>
            <tr>
                <th colspan="3"><input id="map_data" type="text" class="form-control" placeholder="Map" disabled></th>
            </tr>
            <tr>
                <td>
                    <img src="https://i.gifer.com/2iiJ.gif" width="20px" height="20px">
                </td>
                <td>

                </td>
                <td>

                </td>
            </tr>
            <tr>
                <td>

                </td>
                <td>

                </td>
                <td>

                </td>
            </tr>
            <tr>
                <td>

                </td>
                <td>

                </td>
                <td>

                </td>
            </tr>
            <tr>
                <td>

                </td>
                <td>

                </td>
                <td>

                </td>
            </tr>
            <tr>
                <td>

                </td>
                <td>

                </td>
                <td>

                </td>
            </tr>
        </table>

    </div>
</div>

{% endblock %}

{% block scripts %}

<script>

    // var car_event = document.getElementById("car_event");
    var hump_number = document.getElementById("hump_number");
    var car_hump = document.getElementById("car_hump");
    var turn_number = document.getElementById("turn_number");
    var car_turn = document.getElementById("car_turn");
    var car_barcode = document.getElementById("car_barcode");
    var car_distance = document.getElementById("car_distance");
    var car_speed = document.getElementById("car_speed");
    var map_data = document.getElementById("map_data");

    async function getData() {

        while (true) {
            await new Promise(r => setTimeout(r, 2000));
            fetch('http://192.168.25.168')
                .then(response => response.json())
                .then(data => { console.log(data); 
                    // car_event.value = data.car_event;
                    hump_number.value = parseInt(hump_number.value) + 1;
                    car_hump.value = data.car_hump;
                    turn_number.value = parseInt(turn_number.value) + 1;
                    car_turn.value = data.car_turn;
                    car_barcode.value = data.car_barcode;
                    car_distance.value = data.car_distance;
                    car_speed.value = data.car_speed;
                    map_data.value = data.map_data;
                })
        }
    }

</script>

{% endblock %}